# よくある質問とトラブルシューティング

## よくある質問

### `ai` を実行すると「query がない」などでエラーになる

- メッセージを渡していないとエラーになります。`ai 質問内容` のように、依頼文を引数に含めてください。
- タスク名だけを指定してメッセージを省略した場合も、そのタスクが「メッセージ不要」でない限りエラーになることがあります。`ai --help` で利用可能なオプションを確認してください。

### セッションの履歴が `ai` に反映されない

- `ai` は環境変数 `AISH_SESSION` が設定されているとき、そのディレクトリをセッションとして参照します。通常は `aish` のシェル内で `ai` を実行すると自動で設定されます。
- 通常のシェルから直接 `ai` を呼んでいる場合は、セッションは使われません。`aish` を起動してからその中で `ai` を実行すると、同じセッションの履歴がコンテキストに含まれます。

### 利用可能なプロファイルやモデルはどこで確認する？

- `ai -L` または `ai --list-profiles` でプロファイル一覧を表示できます。
- モデル名は `ai -m モデル名` で指定します。プロファイルに紐づくデフォルトモデルは、`profiles.json` や各プロバイダの設定を参照してください。

### API キーやネットワークエラーが出る

- 使用する LLM プロバイダ（OpenAI、Google など）に合わせて、必要な環境変数（例: `OPENAI_API_KEY`、`GOOGLE_API_KEY`）が設定されているか確認してください。
- ネットワークが不安定な場合や、プロバイダ側の制限に引っかかっている場合は、しばらく待って再試行するか、`-v` でログを確認してエラー内容を確認してください。

## トラブルシューティングのコツ

- **`-v` / `--verbose`** を付けると、デバッグログが標準エラーに出力されます。どのコンテキストが組み立てられているか、どの段階で失敗しているかを切り分けるのに役立ちます。
- セッションをリセットして試したい場合は、`aish clear` で Part ファイルを削除し、新しい会話からやり直せます。
- それでも解決しない場合は、リポジトリの Issue や開発者向け情報（AGENTS.md など）を参照してください。
